module prime_main_licm

const data $fmt = {
  "prime(%d) = %d\n",
  0x0_b
}

export function w $main(w %argc, l %argv) {
start:
  %0 = add.l %argv, 0x8_l;
  %p.2 = ld.l %0;
  %n.1 = call.w $atoi(%p.2);
  %n.2 = copy.w %n.1;
  %m.2 = copy.w 0x1_w;
  %i.2 = copy.w 0x1_w;
  while sgt.w %n.2, 0x0_w {
    %i.3 = copy.w %i.2;
    loop {
      %b.1 = call.w $is_prime(%i.3);
      %2 = eq.w %b.1, 0x0_w;
      %3 = add.w %i.3, 0x1_w;
      if %2 {
        %i.3 = copy.w %3
      } else {
        break
      }
    };
    %k.1 = call.w $printf($fmt, ..., %m.2, %i.3);
    %4 = sub.w %n.2, 0x1_w;
    %5 = add.w %m.2, 0x1_w;
    %n.2 = copy.w %4;
    %m.2 = copy.w %5;
    %i.2 = copy.w %3
  };
  ret 0x0_w
}
